# 班级点名器

一个基于Flask的班级随机点名网页应用，具有精美的动画效果和音效反馈。

## 功能特点

- 随机点名功能，带有流畅的动画效果
- 实时音效反馈系统
- 学生名单管理（添加/删除）
- 精美的视觉效果（五彩纸屑、闪光效果等）
- 完全本地运行，无需联网
- 响应式设计，适配各种屏幕尺寸
- 支持打包为独立可执行文件

## 技术栈

- 后端：Flask
- 前端：原生JavaScript + CSS3
- 数据存储：JSON文件
- 动画：CSS3 Animations + JavaScript Animations
- 打包工具：PyInstaller

## 安装说明

1. 确保已安装Python 3.6+
2. 安装依赖：
```bash
pip install -r requirements.txt
```

3. 运行应用：
```bash
# 推荐使用 run_app.py 启动，它会处理环境检查、端口选择和启动
python run_app.py
```
应用启动后会自动尝试打开浏览器。如果未自动打开，请手动访问日志中提示的 `http://127.0.0.1:端口号` 地址。

也可以直接运行 `main.py` (用于开发或调试):
```bash
python main.py
```

## 使用说明

1.  **启动应用**: 双击 `run_app.exe` (或者通过命令行运行 `python run_app.py`)。
    *   **单例运行**: 如果应用已经在后台运行，再次启动会直接打开现有的应用页面，而不是启动一个新的实例。
2.  **添加学生**: 在"添加学生"输入框中输入学生姓名，点击"添加"按钮或按回车键。
3.  **编辑/删除学生**: 在学生列表中，可以直接点击学生姓名进行修改（修改后按Enter或点击✓保存，按Esc或点击✗取消），或点击🗑️图标删除学生。
4.  **随机点名**: 点击页面上方的"开始点名"按钮。
5.  **退出应用**: 关闭 Flask 服务器运行的命令行窗口 (如果可见)，或者关闭浏览器页面通常不会完全退出后台进程，可能需要手动结束进程（或等待系统处理）。

## 项目结构

```
.
├── README.md              # 项目说明文档
├── requirements.txt       # Python依赖包列表
├── main.py                # Flask应用主文件 (定义路由和逻辑)
├── run_app.py             # 应用启动脚本 (处理环境、端口、启动main.py)
├── build.bat              # Windows打包脚本 (可选)
├── namepicker.spec        # PyInstaller打包配置 (可选)
├── students.json          # 学生数据存储文件
├── app_log.txt            # 应用日志文件
├── 使用说明.md            # 详细使用说明 (可选)
├── 打包说明.txt           # 打包相关说明 (可选)
├── static/                # 静态资源目录 (存放音效等)
│   ├── roll.mp3
│   ├── select.mp3
│   └── click.mp3
└── templates/             # 模板目录 (存放HTML)
    └── index.html
```

## 注意事项

1.  学生名单保存在本地的 `students.json` 文件中。
2.  应用日志保存在 `app_log.txt` 中，便于排查问题。
3.  建议使用现代浏览器（Chrome、Firefox、Edge等）以获得最佳体验。
4.  **单例启动**: 应用启动时会检查端口 `5000` 到 `5050` 是否被占用。
    *   如果检测到端口被占用，会尝试向该端口发送一个特殊的 "ping" 请求来确认是否为本应用的另一个实例。
    *   只有确认是本应用实例后，才会打开现有实例的页面并退出当前启动。
    *   如果端口被其他程序占用，或者 "ping" 验证失败，则会继续尝试寻找其他可用端口启动新实例。
5.  如果所有检查的端口都被占用（无论是否为本应用实例），且没有找到可启动的空闲端口，应用将无法启动。

## 开发者说明

- 音效系统使用Web Audio API
- 动画使用requestAnimationFrame实现流畅效果
- 使用CSS3 transform和animation实现视觉效果
- 数据持久化使用JSON文件存储
- 使用PyInstaller进行应用打包
- 日志系统记录应用运行状态

## 许可证

MIT License 